## 项目介绍

[TOC]


   
# 1. 内容项目link
## 1.1 内容域设计

主要负责内容域和互动域
内容域包含内容的发布，存储，审核，上线，下线等操作
互动域包含内容的点赞，评论，关注等操作

1. 内容的修改上线审核，采用状态机
   1. 草稿
   2. 审核中
   3. 审核成功-上线
   4. 审核失败
   5. 下线
   6. 删除
2. 内容状态修改采用事件驱动
   1. applicationEvent

## 2.2 互动域设计
评论模块拆分为两个模块，评论写和评论读
### 2.2.1 评论写模块
评论写采用分库分表，分512个库，使用targetId作为分库key，然后再通过事务或者其它工具写userId纬度映射，用来支撑用户查看自己的评论
### 2.2.2 评论读模块
评论读分成两部分，一部分是评论sequence，另一部分事评论entity，热门的内容会将内容和评论id的count缓存到redis zset中用来实现排序，拿到sequence后通过缓存回源拿到缓存entity
用户对level1 的评论进行互动后删除缓存

# 3. 游戏域
游戏域主要做游戏相关的逻辑，比如游戏配置模块，游戏活动模块，和商业化能力建设
## 3.1 游戏活动模块
游戏活动模块主要做签到任务和冲刺任务。签到任务就是每日签到，如果达到累计多少天就发放累计签到奖励，增加版本，防止任务周期内修改任务
冲刺任务就是在用户访问时查看是否命中任务规则按照优先级等，如果命中自动领取任务，然后发放奖励， 除了coin，体力后续增加了优惠券奖励， 上线后dau增加10%， 
## 3.2 商业化模块
制作任务中心， 包含任务创建， 奖励创建等。
发布任务，关联奖励以及完成条件，对接浏览收藏加购等事件

主要任务有：
1. 浏览ns 兑换体力
2. 浏览ns 兑换游戏内步数
3. 收藏 兑换优惠券， 每周一次
4. 下单兑换优惠券，每单一个，需要手动领取任务 

## 3.3 数据分析
分析游戏用户关卡流失情况，针对难度较高，流失严重的关卡修改难度提供通关成功绿，通关成功率从21%-> 65%, DAU 略微提升




# 3. DDD结构
包目录

1. api
2. service
   1. hsf service
   2. http servcie
3. applicaiton
   1. application service
4. domain
   1. content domain
      1. draft
      2. publish
      3. audit
      4. online
      5. offline
   2. creator domain
   3. interactive domain
      1. like
      2. comment
      3. follow
   4. infrastrature
      1. repository
      2. event
      3. message
      4. cache
      5. queue
      6. scheduler